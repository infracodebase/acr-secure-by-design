{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_TF_2", "bc_check_id": "BC_CROSS_2", "check_name": "Ensure Terraform module sources use a tag with a version number", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[32, "module \"acr\" {\n"], [33, "  source  = \"Azure/avm-res-containerregistry-registry/azurerm\"\n"], [34, "  version = \"~> 0.5.0\"\n"], [35, "\n"], [36, "  # Basic configuration\n"], [37, "  name                = local.acr_name\n"], [38, "  location            = var.location\n"], [39, "  resource_group_name = var.resource_group_name\n"], [40, "  sku                 = \"Premium\" # Premium required for security features\n"], [41, "\n"], [42, "  # Security configuration - OWASP compliant\n"], [43, "  public_network_access_enabled = false # Zero Trust: no public access\n"], [44, "  admin_enabled                 = false # OWASP: avoid default credentials\n"], [45, "  export_policy_enabled         = false # Prevent unauthorized export\n"], [46, "  zone_redundancy_enabled       = var.enable_zone_redundancy\n"], [47, "\n"], [48, "  # Content trust and security policies\n"], [49, "  enable_trust_policy       = true  # OWASP: secure content verification\n"], [50, "  quarantine_policy_enabled = true  # OWASP: prevent malicious content\n"], [51, "  retention_policy_in_days  = var.retention_days_untagged\n"], [52, "\n"], [53, "  # Network security\n"], [54, "  network_rule_set = {\n"], [55, "    default_action = \"Deny\"\n"], [56, "    ip_rule        = [] # No public IP access for Zero Trust\n"], [57, "  }\n"], [58, "  network_rule_bypass_option = \"AzureServices\"\n"], [59, "\n"], [60, "  # Data endpoint for performance\n"], [61, "  data_endpoint_enabled = true\n"], [62, "\n"], [63, "  # Customer-managed encryption\n"], [64, "  customer_managed_key = var.cmk_enabled ? {\n"], [65, "    key_vault_resource_id = var.key_vault_id\n"], [66, "    key_name              = \"acr-encryption-key\"\n"], [67, "    user_assigned_identity = {\n"], [68, "      resource_id = azurerm_user_assigned_identity.acr_identity.id\n"], [69, "    }\n"], [70, "  } : null\n"], [71, "\n"], [72, "  # Managed identity for secure operations\n"], [73, "  managed_identities = {\n"], [74, "    system_assigned = true\n"], [75, "    user_assigned_resource_ids = var.cmk_enabled ? [\n"], [76, "      azurerm_user_assigned_identity.acr_identity.id\n"], [77, "    ] : []\n"], [78, "  }\n"], [79, "\n"], [80, "  # Geo-replication for high availability\n"], [81, "  georeplications = [\n"], [82, "    for location in var.geo_replication_locations : {\n"], [83, "      location                  = location\n"], [84, "      regional_endpoint_enabled = true\n"], [85, "      zone_redundancy_enabled   = true\n"], [86, "    }\n"], [87, "  ]\n"], [88, "\n"], [89, "  # Private endpoint configuration\n"], [90, "  private_endpoints = {\n"], [91, "    primary = {\n"], [92, "      name                          = \"${var.naming_prefix}-acr-pe\"\n"], [93, "      subnet_resource_id            = var.hub_private_endpoints_subnet_id\n"], [94, "      private_dns_zone_resource_ids = [var.acr_private_dns_zone_id]\n"], [95, "\n"], [96, "      # Network interface configuration\n"], [97, "      network_interface_name = \"${var.naming_prefix}-acr-pe-nic\"\n"], [98, "\n"], [99, "      tags = var.common_tags\n"], [100, "    }\n"], [101, "  }\n"], [102, "\n"], [103, "  # Comprehensive diagnostic settings for audit compliance\n"], [104, "  diagnostic_settings = {\n"], [105, "    audit = {\n"], [106, "      name                       = \"acr-audit-diagnostics\"\n"], [107, "      workspace_resource_id      = var.log_analytics_workspace_id\n"], [108, "      log_categories             = []\n"], [109, "      log_groups                = [\"audit\", \"allLogs\"]\n"], [110, "      metric_categories         = [\"AllMetrics\"]\n"], [111, "      log_analytics_destination_type = \"Dedicated\"\n"], [112, "    }\n"], [113, "  }\n"], [114, "\n"], [115, "  # Scope maps for fine-grained access control - OWASP: secure access management\n"], [116, "  scope_maps = {\n"], [117, "    readonly = {\n"], [118, "      name        = \"readonly-scope\"\n"], [119, "      description = \"Read-only access for monitoring and compliance\"\n"], [120, "      actions = [\n"], [121, "        \"repositories/*/content/read\",\n"], [122, "        \"repositories/*/metadata/read\"\n"], [123, "      ]\n"], [124, "    }\n"], [125, "\n"], [126, "    cicd_build = {\n"], [127, "      name        = \"cicd-build-scope\"\n"], [128, "      description = \"CI/CD pipeline access for secure image building\"\n"], [129, "      actions = [\n"], [130, "        \"repositories/*/content/read\",\n"], [131, "        \"repositories/*/content/write\",\n"], [132, "        \"repositories/*/metadata/read\",\n"], [133, "        \"repositories/*/metadata/write\"\n"], [134, "      ]\n"], [135, "\n"], [136, "      registry_tokens = {\n"], [137, "        cicd_token = {\n"], [138, "          name    = \"cicd-secure-token\"\n"], [139, "          enabled = true\n"], [140, "          passwords = {\n"], [141, "            password1 = {\n"], [142, "              expiry = timeadd(timestamp(), \"2160h\") # 90 days\n"], [143, "            }\n"], [144, "          }\n"], [145, "        }\n"], [146, "      }\n"], [147, "    }\n"], [148, "\n"], [149, "    production_deploy = {\n"], [150, "      name        = \"production-deploy-scope\"\n"], [151, "      description = \"Production deployment access with pull-only permissions\"\n"], [152, "      actions = [\n"], [153, "        \"repositories/*/content/read\",\n"], [154, "        \"repositories/*/metadata/read\"\n"], [155, "      ]\n"], [156, "    }\n"], [157, "  }\n"], [158, "\n"], [159, "  # Role assignments for secure access - OWASP: principle of least privilege\n"], [160, "  role_assignments = {\n"], [161, "    acr_pull_aks = {\n"], [162, "      role_definition_id_or_name = \"AcrPull\"\n"], [163, "      principal_id               = var.aks_kubelet_identity_object_id\n"], [164, "      description               = \"AKS kubelet identity pull access\"\n"], [165, "      principal_type            = \"ServicePrincipal\"\n"], [166, "    }\n"], [167, "  }\n"], [168, "\n"], [169, "  # Tags\n"], [170, "  tags = merge(var.common_tags, {\n"], [171, "    Service     = \"ContainerRegistry\"\n"], [172, "    Purpose     = \"ZeroTrust\"\n"], [173, "    Compliance  = \"OWASP-Top10\"\n"], [174, "    SecurityLevel = \"High\"\n"], [175, "  })\n"], [176, "}\n"]], "file_path": "/terraform/modules/acr/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "repo_file_path": "/terraform/modules/acr/main.tf", "file_line_range": [32, 176], "resource": "module.acr.acr", "evaluations": null, "check_class": "checkov.terraform.checks.module.generic.RevisionVersionTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [134, 152], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-tag", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "breadcrumbs": {"role_assignments.acr_pull_aks.principal_id": [{"type": "variable", "name": "aks_kubelet_identity_object_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "role_assignments.acr_pull_aks": [{"type": "variable", "name": "aks_kubelet_identity_object_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "managed_identities.user_assigned_resource_ids": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "cmk_enabled", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "diagnostic_settings.audit.workspace_resource_id": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "log_analytics_workspace_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "diagnostic_settings.audit": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "log_analytics_workspace_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary.private_dns_zone_resource_ids": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "acr_private_dns_zone_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "location": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary.subnet_resource_id": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "hub_private_endpoints_subnet_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "zone_redundancy_enabled": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "enable_zone_redundancy", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "retention_policy_in_days": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "retention_days_untagged", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "georeplications": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "geo_replication_locations", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "customer_managed_key": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "cmk_enabled", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary.tags": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary.name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "private_endpoints.primary.network_interface_name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 8, "source_module_object": null}]}}, {"check_id": "CKV_TF_2", "bc_check_id": "BC_CROSS_2", "check_name": "Ensure Terraform module sources use a tag with a version number", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[21, "module \"aks_production\" {\n"], [22, "  source  = \"Azure/avm-ptn-aks-production/azurerm\"\n"], [23, "  version = \"~> 0.5.0\"\n"], [24, "\n"], [25, "  # Basic configuration\n"], [26, "  name                = \"${var.naming_prefix}-aks\"\n"], [27, "  location            = var.location\n"], [28, "  resource_group_name = var.resource_group_name\n"], [29, "\n"], [30, "  # Kubernetes configuration\n"], [31, "  kubernetes_version = var.kubernetes_version\n"], [32, "\n"], [33, "  # Network configuration for Zero Trust\n"], [34, "  network = {\n"], [35, "    node_subnet_id = var.system_pool_subnet_id\n"], [36, "    pod_cidr       = var.pod_cidr\n"], [37, "    service_cidr   = var.service_cidr\n"], [38, "    dns_service_ip = var.dns_service_ip\n"], [39, "  }\n"], [40, "\n"], [41, "  # Private cluster configuration - OWASP: secure network access\n"], [42, "  private_dns_zone_id         = var.private_dns_zone_id\n"], [43, "  private_dns_zone_id_enabled = true\n"], [44, "\n"], [45, "  # Network policy for Zero Trust micro-segmentation\n"], [46, "  network_policy = var.enable_network_policy\n"], [47, "\n"], [48, "  # Outbound traffic control\n"], [49, "  outbound_type = var.outbound_type\n"], [50, "\n"], [51, "  # ACR integration with private endpoint\n"], [52, "  acr = var.acr_id != \"\" ? {\n"], [53, "    name                          = split(\"/\", var.acr_id)[8] # Extract ACR name from resource ID\n"], [54, "    subnet_resource_id            = var.private_link_subnet_id\n"], [55, "    private_dns_zone_resource_ids = [var.acr_private_dns_zone_id]\n"], [56, "    zone_redundancy_enabled       = var.enable_zone_redundancy\n"], [57, "  } : null\n"], [58, "\n"], [59, "  # Managed identity configuration\n"], [60, "  managed_identities = {\n"], [61, "    user_assigned_resource_ids = var.user_assigned_identity_ids\n"], [62, "  }\n"], [63, "\n"], [64, "  # Azure AD integration - OWASP: secure authentication\n"], [65, "  rbac_aad_azure_rbac_enabled     = var.enable_azure_rbac\n"], [66, "  rbac_aad_tenant_id              = var.aad_tenant_id\n"], [67, "  rbac_aad_admin_group_object_ids = var.aad_admin_group_object_ids\n"], [68, "\n"], [69, "  # Default node pool configuration\n"], [70, "  default_node_pool_vm_sku = var.node_vm_size\n"], [71, "  os_sku                   = var.os_sku\n"], [72, "  os_disk_type            = var.os_disk_type\n"], [73, "\n"], [74, "  # Additional node pools for workload separation\n"], [75, "  node_pools = {\n"], [76, "    # User workload pool\n"], [77, "    user_pool = {\n"], [78, "      name                 = \"userpool\"\n"], [79, "      vm_size              = var.node_vm_size\n"], [80, "      orchestrator_version = var.kubernetes_version\n"], [81, "      max_count           = var.user_node_count_max\n"], [82, "      min_count           = var.user_node_count_min\n"], [83, "      os_sku              = var.os_sku\n"], [84, "      os_disk_type        = var.os_disk_type\n"], [85, "      mode                = \"User\"\n"], [86, "      labels = merge(var.node_labels, {\n"], [87, "        \"nodepool-type\" = \"user\"\n"], [88, "        \"workload\"      = \"general\"\n"], [89, "      })\n"], [90, "      tags = merge(var.common_tags, {\n"], [91, "        NodePool = \"User\"\n"], [92, "        Purpose  = \"WorkloadNodes\"\n"], [93, "      })\n"], [94, "    }\n"], [95, "\n"], [96, "    # GPU pool for ML workloads (if enabled)\n"], [97, "    gpu_pool = var.enable_gpu_nodes ? {\n"], [98, "      name                 = \"gpupool\"\n"], [99, "      vm_size              = var.gpu_vm_size\n"], [100, "      orchestrator_version = var.kubernetes_version\n"], [101, "      max_count           = var.gpu_node_count_max\n"], [102, "      min_count           = var.gpu_node_count_min\n"], [103, "      os_sku              = var.os_sku\n"], [104, "      os_disk_type        = var.os_disk_type\n"], [105, "      mode                = \"User\"\n"], [106, "      labels = merge(var.node_labels, {\n"], [107, "        \"nodepool-type\"    = \"gpu\"\n"], [108, "        \"workload\"         = \"ml\"\n"], [109, "        \"accelerator\"      = \"nvidia-gpu\"\n"], [110, "      })\n"], [111, "      tags = merge(var.common_tags, {\n"], [112, "        NodePool = \"GPU\"\n"], [113, "        Purpose  = \"MLWorkloads\"\n"], [114, "      })\n"], [115, "    } : null\n"], [116, "  }\n"], [117, "\n"], [118, "  # Prometheus monitoring configuration\n"], [119, "  monitor_metrics = var.enable_prometheus ? {\n"], [120, "    annotations_allowed = \"prometheus.io/scrape,prometheus.io/port,prometheus.io/path\"\n"], [121, "    labels_allowed      = \"app.kubernetes.io/name,app.kubernetes.io/instance\"\n"], [122, "  } : null\n"], [123, "\n"], [124, "  # Security tags\n"], [125, "  tags = merge(var.common_tags, {\n"], [126, "    Service       = \"Kubernetes\"\n"], [127, "    Purpose       = \"ZeroTrust\"\n"], [128, "    Compliance    = \"OWASP-Top10\"\n"], [129, "    SecurityLevel = \"High\"\n"], [130, "    NetworkPolicy = var.enable_network_policy\n"], [131, "    PrivateCluster = \"true\"\n"], [132, "  })\n"], [133, "}\n"]], "file_path": "/terraform/modules/aks/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "repo_file_path": "/terraform/modules/aks/main.tf", "file_line_range": [21, 133], "resource": "module.aks.aks_production", "evaluations": null, "check_class": "checkov.terraform.checks.module.generic.RevisionVersionTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [155, 204], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-tag", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "breadcrumbs": {"network.pod_cidr": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "network.service_cidr": [{"type": "variable", "name": "service_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "network.dns_service_ip": [{"type": "variable", "name": "dns_service_ip", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "os_sku": [{"type": "variable", "name": "os_sku", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.gpu_pool": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "kubernetes_version", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.os_sku": [{"type": "variable", "name": "os_sku", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "user_node_count_max", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "os_disk_type": [{"type": "variable", "name": "os_disk_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.os_disk_type": [{"type": "variable", "name": "os_disk_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "rbac_aad_azure_rbac_enabled": [{"type": "variable", "name": "enable_azure_rbac", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "managed_identities.user_assigned_resource_ids": [{"type": "variable", "name": "user_assigned_identity_ids", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "acr": [{"type": "variable", "name": "enable_zone_redundancy", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.labels": [{"type": "variable", "name": "node_labels", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "private_dns_zone_id": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_dns_zone_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.orchestrator_version": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "kubernetes_version", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "enable_network_policy", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "network.node_subnet_id": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "system_pool_subnet_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.min_count": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "user_node_count_min", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "kubernetes_version": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "kubernetes_version", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "monitor_metrics": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "enable_prometheus", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "outbound_type": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "outbound_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "rbac_aad_tenant_id": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "aad_tenant_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "default_node_pool_vm_sku": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_vm_size", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_network_security_group.aks_nsg", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "module_connection": false}], "node_pools.user_pool.tags": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.vm_size": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_vm_size", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "rbac_aad_admin_group_object_ids": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "aad_admin_group_object_ids", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "network_policy": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "enable_network_policy", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.max_count": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "user_node_count_max", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 9, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_9", "bc_check_id": "BC_AZR_NETWORKING_2", "check_name": "Ensure that RDP access is restricted from the internet", "check_result": {"result": "PASSED", "evaluated_keys": ["security_rule"]}, "code_block": [[264, "resource \"azurerm_network_security_group\" \"aks_nsg\" {\n"], [265, "  name                = \"${var.naming_prefix}-aks-nsg\"\n"], [266, "  location            = var.location\n"], [267, "  resource_group_name = var.resource_group_name\n"], [268, "\n"], [269, "  # Deny all inbound traffic by default (Zero Trust)\n"], [270, "  security_rule {\n"], [271, "    name                       = \"DenyAllInbound\"\n"], [272, "    priority                   = 4096\n"], [273, "    direction                  = \"Inbound\"\n"], [274, "    access                     = \"Deny\"\n"], [275, "    protocol                   = \"*\"\n"], [276, "    source_port_range          = \"*\"\n"], [277, "    destination_port_range     = \"*\"\n"], [278, "    source_address_prefix      = \"*\"\n"], [279, "    destination_address_prefix = \"*\"\n"], [280, "  }\n"], [281, "\n"], [282, "  # Allow internal cluster communication\n"], [283, "  security_rule {\n"], [284, "    name                       = \"AllowClusterInternal\"\n"], [285, "    priority                   = 1000\n"], [286, "    direction                  = \"Inbound\"\n"], [287, "    access                     = \"Allow\"\n"], [288, "    protocol                   = \"*\"\n"], [289, "    source_port_range          = \"*\"\n"], [290, "    destination_port_range     = \"*\"\n"], [291, "    source_address_prefix      = var.pod_cidr\n"], [292, "    destination_address_prefix = var.pod_cidr\n"], [293, "  }\n"], [294, "\n"], [295, "  # Allow Azure Load Balancer\n"], [296, "  security_rule {\n"], [297, "    name                       = \"AllowAzureLoadBalancer\"\n"], [298, "    priority                   = 1001\n"], [299, "    direction                  = \"Inbound\"\n"], [300, "    access                     = \"Allow\"\n"], [301, "    protocol                   = \"*\"\n"], [302, "    source_port_range          = \"*\"\n"], [303, "    destination_port_range     = \"*\"\n"], [304, "    source_address_prefix      = \"AzureLoadBalancer\"\n"], [305, "    destination_address_prefix = \"*\"\n"], [306, "  }\n"], [307, "\n"], [308, "  tags = merge(var.common_tags, {\n"], [309, "    Purpose = \"AKSNetworkSecurity\"\n"], [310, "  })\n"], [311, "}\n"]], "file_path": "/terraform/modules/aks/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "repo_file_path": "/terraform/modules/aks/main.tf", "file_line_range": [264, 311], "resource": "module.aks.azurerm_network_security_group.aks_nsg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleRDPAccessRestricted", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Purpose": "AKSNetworkSecurity"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [155, 204], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-2", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "breadcrumbs": {"security_rule.1.destination_address_prefix": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "security_rule.1": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "security_rule.1.source_address_prefix": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_network_security_group.aks_nsg", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "module_connection": false}], "tags": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 9, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_77", "bc_check_id": "BC_AZR_NETWORKING_22", "check_name": "Ensure that UDP Services are restricted from the Internet ", "check_result": {"result": "PASSED", "evaluated_keys": ["security_rule"]}, "code_block": [[264, "resource \"azurerm_network_security_group\" \"aks_nsg\" {\n"], [265, "  name                = \"${var.naming_prefix}-aks-nsg\"\n"], [266, "  location            = var.location\n"], [267, "  resource_group_name = var.resource_group_name\n"], [268, "\n"], [269, "  # Deny all inbound traffic by default (Zero Trust)\n"], [270, "  security_rule {\n"], [271, "    name                       = \"DenyAllInbound\"\n"], [272, "    priority                   = 4096\n"], [273, "    direction                  = \"Inbound\"\n"], [274, "    access                     = \"Deny\"\n"], [275, "    protocol                   = \"*\"\n"], [276, "    source_port_range          = \"*\"\n"], [277, "    destination_port_range     = \"*\"\n"], [278, "    source_address_prefix      = \"*\"\n"], [279, "    destination_address_prefix = \"*\"\n"], [280, "  }\n"], [281, "\n"], [282, "  # Allow internal cluster communication\n"], [283, "  security_rule {\n"], [284, "    name                       = \"AllowClusterInternal\"\n"], [285, "    priority                   = 1000\n"], [286, "    direction                  = \"Inbound\"\n"], [287, "    access                     = \"Allow\"\n"], [288, "    protocol                   = \"*\"\n"], [289, "    source_port_range          = \"*\"\n"], [290, "    destination_port_range     = \"*\"\n"], [291, "    source_address_prefix      = var.pod_cidr\n"], [292, "    destination_address_prefix = var.pod_cidr\n"], [293, "  }\n"], [294, "\n"], [295, "  # Allow Azure Load Balancer\n"], [296, "  security_rule {\n"], [297, "    name                       = \"AllowAzureLoadBalancer\"\n"], [298, "    priority                   = 1001\n"], [299, "    direction                  = \"Inbound\"\n"], [300, "    access                     = \"Allow\"\n"], [301, "    protocol                   = \"*\"\n"], [302, "    source_port_range          = \"*\"\n"], [303, "    destination_port_range     = \"*\"\n"], [304, "    source_address_prefix      = \"AzureLoadBalancer\"\n"], [305, "    destination_address_prefix = \"*\"\n"], [306, "  }\n"], [307, "\n"], [308, "  tags = merge(var.common_tags, {\n"], [309, "    Purpose = \"AKSNetworkSecurity\"\n"], [310, "  })\n"], [311, "}\n"]], "file_path": "/terraform/modules/aks/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "repo_file_path": "/terraform/modules/aks/main.tf", "file_line_range": [264, 311], "resource": "module.aks.azurerm_network_security_group.aks_nsg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleUDPAccessRestricted", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Purpose": "AKSNetworkSecurity"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [155, 204], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-udp-services-are-restricted-from-the-internet", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "breadcrumbs": {"security_rule.1.destination_address_prefix": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "security_rule.1": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "security_rule.1.source_address_prefix": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_network_security_group.aks_nsg", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "module_connection": false}], "tags": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 9, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_160", "bc_check_id": "BC_AZR_NETWORKING_57", "check_name": "Ensure that HTTP (port 80) access is restricted from the internet", "check_result": {"result": "PASSED", "evaluated_keys": ["security_rule"]}, "code_block": [[264, "resource \"azurerm_network_security_group\" \"aks_nsg\" {\n"], [265, "  name                = \"${var.naming_prefix}-aks-nsg\"\n"], [266, "  location            = var.location\n"], [267, "  resource_group_name = var.resource_group_name\n"], [268, "\n"], [269, "  # Deny all inbound traffic by default (Zero Trust)\n"], [270, "  security_rule {\n"], [271, "    name                       = \"DenyAllInbound\"\n"], [272, "    priority                   = 4096\n"], [273, "    direction                  = \"Inbound\"\n"], [274, "    access                     = \"Deny\"\n"], [275, "    protocol                   = \"*\"\n"], [276, "    source_port_range          = \"*\"\n"], [277, "    destination_port_range     = \"*\"\n"], [278, "    source_address_prefix      = \"*\"\n"], [279, "    destination_address_prefix = \"*\"\n"], [280, "  }\n"], [281, "\n"], [282, "  # Allow internal cluster communication\n"], [283, "  security_rule {\n"], [284, "    name                       = \"AllowClusterInternal\"\n"], [285, "    priority                   = 1000\n"], [286, "    direction                  = \"Inbound\"\n"], [287, "    access                     = \"Allow\"\n"], [288, "    protocol                   = \"*\"\n"], [289, "    source_port_range          = \"*\"\n"], [290, "    destination_port_range     = \"*\"\n"], [291, "    source_address_prefix      = var.pod_cidr\n"], [292, "    destination_address_prefix = var.pod_cidr\n"], [293, "  }\n"], [294, "\n"], [295, "  # Allow Azure Load Balancer\n"], [296, "  security_rule {\n"], [297, "    name                       = \"AllowAzureLoadBalancer\"\n"], [298, "    priority                   = 1001\n"], [299, "    direction                  = \"Inbound\"\n"], [300, "    access                     = \"Allow\"\n"], [301, "    protocol                   = \"*\"\n"], [302, "    source_port_range          = \"*\"\n"], [303, "    destination_port_range     = \"*\"\n"], [304, "    source_address_prefix      = \"AzureLoadBalancer\"\n"], [305, "    destination_address_prefix = \"*\"\n"], [306, "  }\n"], [307, "\n"], [308, "  tags = merge(var.common_tags, {\n"], [309, "    Purpose = \"AKSNetworkSecurity\"\n"], [310, "  })\n"], [311, "}\n"]], "file_path": "/terraform/modules/aks/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "repo_file_path": "/terraform/modules/aks/main.tf", "file_line_range": [264, 311], "resource": "module.aks.azurerm_network_security_group.aks_nsg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleHTTPAccessRestricted", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Purpose": "AKSNetworkSecurity"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [155, 204], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-azure-http-port-80-access-from-the-internet-is-restricted", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "breadcrumbs": {"security_rule.1.destination_address_prefix": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "security_rule.1": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "security_rule.1.source_address_prefix": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_network_security_group.aks_nsg", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "module_connection": false}], "tags": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 9, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_10", "bc_check_id": "BC_AZR_NETWORKING_3", "check_name": "Ensure that SSH access is restricted from the internet", "check_result": {"result": "PASSED", "evaluated_keys": ["security_rule"]}, "code_block": [[264, "resource \"azurerm_network_security_group\" \"aks_nsg\" {\n"], [265, "  name                = \"${var.naming_prefix}-aks-nsg\"\n"], [266, "  location            = var.location\n"], [267, "  resource_group_name = var.resource_group_name\n"], [268, "\n"], [269, "  # Deny all inbound traffic by default (Zero Trust)\n"], [270, "  security_rule {\n"], [271, "    name                       = \"DenyAllInbound\"\n"], [272, "    priority                   = 4096\n"], [273, "    direction                  = \"Inbound\"\n"], [274, "    access                     = \"Deny\"\n"], [275, "    protocol                   = \"*\"\n"], [276, "    source_port_range          = \"*\"\n"], [277, "    destination_port_range     = \"*\"\n"], [278, "    source_address_prefix      = \"*\"\n"], [279, "    destination_address_prefix = \"*\"\n"], [280, "  }\n"], [281, "\n"], [282, "  # Allow internal cluster communication\n"], [283, "  security_rule {\n"], [284, "    name                       = \"AllowClusterInternal\"\n"], [285, "    priority                   = 1000\n"], [286, "    direction                  = \"Inbound\"\n"], [287, "    access                     = \"Allow\"\n"], [288, "    protocol                   = \"*\"\n"], [289, "    source_port_range          = \"*\"\n"], [290, "    destination_port_range     = \"*\"\n"], [291, "    source_address_prefix      = var.pod_cidr\n"], [292, "    destination_address_prefix = var.pod_cidr\n"], [293, "  }\n"], [294, "\n"], [295, "  # Allow Azure Load Balancer\n"], [296, "  security_rule {\n"], [297, "    name                       = \"AllowAzureLoadBalancer\"\n"], [298, "    priority                   = 1001\n"], [299, "    direction                  = \"Inbound\"\n"], [300, "    access                     = \"Allow\"\n"], [301, "    protocol                   = \"*\"\n"], [302, "    source_port_range          = \"*\"\n"], [303, "    destination_port_range     = \"*\"\n"], [304, "    source_address_prefix      = \"AzureLoadBalancer\"\n"], [305, "    destination_address_prefix = \"*\"\n"], [306, "  }\n"], [307, "\n"], [308, "  tags = merge(var.common_tags, {\n"], [309, "    Purpose = \"AKSNetworkSecurity\"\n"], [310, "  })\n"], [311, "}\n"]], "file_path": "/terraform/modules/aks/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "repo_file_path": "/terraform/modules/aks/main.tf", "file_line_range": [264, 311], "resource": "module.aks.azurerm_network_security_group.aks_nsg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleSSHAccessRestricted", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Purpose": "AKSNetworkSecurity"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [155, 204], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-3", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "breadcrumbs": {"security_rule.1.destination_address_prefix": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "security_rule.1": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "security_rule.1.source_address_prefix": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_network_security_group.aks_nsg", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "module_connection": false}], "tags": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 9, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_111", "bc_check_id": "BC_AZR_GENERAL_41", "check_name": "Ensure that key vault enables soft delete", "check_result": {"result": "PASSED", "evaluated_keys": ["soft_delete_enabled"]}, "code_block": [[71, "resource \"azurerm_key_vault\" \"main\" {\n"], [72, "  name                = local.key_vault_name\n"], [73, "  location            = var.location\n"], [74, "  resource_group_name = var.resource_group_name\n"], [75, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [76, "  sku_name            = \"premium\"\n"], [77, "\n"], [78, "  # Security configuration - OWASP: comprehensive security\n"], [79, "  enabled_for_disk_encryption     = true\n"], [80, "  enabled_for_deployment          = false  # OWASP: disable unnecessary features\n"], [81, "  enabled_for_template_deployment = false  # OWASP: disable unnecessary features\n"], [82, "  purge_protection_enabled        = true   # OWASP: prevent accidental deletion\n"], [83, "  soft_delete_retention_days      = 90\n"], [84, "\n"], [85, "  # Network access restrictions - Zero Trust\n"], [86, "  public_network_access_enabled = false\n"], [87, "  network_acls {\n"], [88, "    default_action = \"Deny\"\n"], [89, "    bypass         = \"AzureServices\"\n"], [90, "    ip_rules       = var.allowed_ip_ranges\n"], [91, "    virtual_network_subnet_ids = []\n"], [92, "  }\n"], [93, "\n"], [94, "  # RBAC for fine-grained access control\n"], [95, "  enable_rbac_authorization = true\n"], [96, "\n"], [97, "  tags = merge(var.common_tags, {\n"], [98, "    Service = \"KeyVault\"\n"], [99, "    Purpose = \"SecretsManagement\"\n"], [100, "  })\n"], [101, "\n"], [102, "  lifecycle {\n"], [103, "    prevent_destroy = true\n"], [104, "  }\n"], [105, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [71, 105], "resource": "module.management.azurerm_key_vault.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyVaultEnablesSoftDelete", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "KeyVault", "Purpose": "SecretsManagement"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-enables-soft-delete", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"network_acls.ip_rules": [{"type": "variable", "name": "allowed_ip_ranges", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_42", "bc_check_id": "BC_AZR_GENERAL_11", "check_name": "Ensure the key vault is recoverable", "check_result": {"result": "PASSED", "evaluated_keys": ["purge_protection_enabled", "soft_delete_enabled"]}, "code_block": [[71, "resource \"azurerm_key_vault\" \"main\" {\n"], [72, "  name                = local.key_vault_name\n"], [73, "  location            = var.location\n"], [74, "  resource_group_name = var.resource_group_name\n"], [75, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [76, "  sku_name            = \"premium\"\n"], [77, "\n"], [78, "  # Security configuration - OWASP: comprehensive security\n"], [79, "  enabled_for_disk_encryption     = true\n"], [80, "  enabled_for_deployment          = false  # OWASP: disable unnecessary features\n"], [81, "  enabled_for_template_deployment = false  # OWASP: disable unnecessary features\n"], [82, "  purge_protection_enabled        = true   # OWASP: prevent accidental deletion\n"], [83, "  soft_delete_retention_days      = 90\n"], [84, "\n"], [85, "  # Network access restrictions - Zero Trust\n"], [86, "  public_network_access_enabled = false\n"], [87, "  network_acls {\n"], [88, "    default_action = \"Deny\"\n"], [89, "    bypass         = \"AzureServices\"\n"], [90, "    ip_rules       = var.allowed_ip_ranges\n"], [91, "    virtual_network_subnet_ids = []\n"], [92, "  }\n"], [93, "\n"], [94, "  # RBAC for fine-grained access control\n"], [95, "  enable_rbac_authorization = true\n"], [96, "\n"], [97, "  tags = merge(var.common_tags, {\n"], [98, "    Service = \"KeyVault\"\n"], [99, "    Purpose = \"SecretsManagement\"\n"], [100, "  })\n"], [101, "\n"], [102, "  lifecycle {\n"], [103, "    prevent_destroy = true\n"], [104, "  }\n"], [105, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [71, 105], "resource": "module.management.azurerm_key_vault.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyvaultRecoveryEnabled", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "KeyVault", "Purpose": "SecretsManagement"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-the-key-vault-is-recoverable", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"network_acls.ip_rules": [{"type": "variable", "name": "allowed_ip_ranges", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_109", "bc_check_id": "BC_AZR_NETWORKING_33", "check_name": "Ensure that key vault allows firewall rules settings", "check_result": {"result": "PASSED", "evaluated_keys": ["network_acls/[0]/default_action"]}, "code_block": [[71, "resource \"azurerm_key_vault\" \"main\" {\n"], [72, "  name                = local.key_vault_name\n"], [73, "  location            = var.location\n"], [74, "  resource_group_name = var.resource_group_name\n"], [75, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [76, "  sku_name            = \"premium\"\n"], [77, "\n"], [78, "  # Security configuration - OWASP: comprehensive security\n"], [79, "  enabled_for_disk_encryption     = true\n"], [80, "  enabled_for_deployment          = false  # OWASP: disable unnecessary features\n"], [81, "  enabled_for_template_deployment = false  # OWASP: disable unnecessary features\n"], [82, "  purge_protection_enabled        = true   # OWASP: prevent accidental deletion\n"], [83, "  soft_delete_retention_days      = 90\n"], [84, "\n"], [85, "  # Network access restrictions - Zero Trust\n"], [86, "  public_network_access_enabled = false\n"], [87, "  network_acls {\n"], [88, "    default_action = \"Deny\"\n"], [89, "    bypass         = \"AzureServices\"\n"], [90, "    ip_rules       = var.allowed_ip_ranges\n"], [91, "    virtual_network_subnet_ids = []\n"], [92, "  }\n"], [93, "\n"], [94, "  # RBAC for fine-grained access control\n"], [95, "  enable_rbac_authorization = true\n"], [96, "\n"], [97, "  tags = merge(var.common_tags, {\n"], [98, "    Service = \"KeyVault\"\n"], [99, "    Purpose = \"SecretsManagement\"\n"], [100, "  })\n"], [101, "\n"], [102, "  lifecycle {\n"], [103, "    prevent_destroy = true\n"], [104, "  }\n"], [105, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [71, 105], "resource": "module.management.azurerm_key_vault.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyVaultEnablesFirewallRulesSettings", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "KeyVault", "Purpose": "SecretsManagement"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-key-vault-allows-firewall-rules-settings", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"network_acls.ip_rules": [{"type": "variable", "name": "allowed_ip_ranges", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_110", "bc_check_id": "BC_AZR_GENERAL_40", "check_name": "Ensure that key vault enables purge protection", "check_result": {"result": "PASSED", "evaluated_keys": ["purge_protection_enabled"]}, "code_block": [[71, "resource \"azurerm_key_vault\" \"main\" {\n"], [72, "  name                = local.key_vault_name\n"], [73, "  location            = var.location\n"], [74, "  resource_group_name = var.resource_group_name\n"], [75, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [76, "  sku_name            = \"premium\"\n"], [77, "\n"], [78, "  # Security configuration - OWASP: comprehensive security\n"], [79, "  enabled_for_disk_encryption     = true\n"], [80, "  enabled_for_deployment          = false  # OWASP: disable unnecessary features\n"], [81, "  enabled_for_template_deployment = false  # OWASP: disable unnecessary features\n"], [82, "  purge_protection_enabled        = true   # OWASP: prevent accidental deletion\n"], [83, "  soft_delete_retention_days      = 90\n"], [84, "\n"], [85, "  # Network access restrictions - Zero Trust\n"], [86, "  public_network_access_enabled = false\n"], [87, "  network_acls {\n"], [88, "    default_action = \"Deny\"\n"], [89, "    bypass         = \"AzureServices\"\n"], [90, "    ip_rules       = var.allowed_ip_ranges\n"], [91, "    virtual_network_subnet_ids = []\n"], [92, "  }\n"], [93, "\n"], [94, "  # RBAC for fine-grained access control\n"], [95, "  enable_rbac_authorization = true\n"], [96, "\n"], [97, "  tags = merge(var.common_tags, {\n"], [98, "    Service = \"KeyVault\"\n"], [99, "    Purpose = \"SecretsManagement\"\n"], [100, "  })\n"], [101, "\n"], [102, "  lifecycle {\n"], [103, "    prevent_destroy = true\n"], [104, "  }\n"], [105, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [71, 105], "resource": "module.management.azurerm_key_vault.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyVaultEnablesPurgeProtection", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "KeyVault", "Purpose": "SecretsManagement"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-enables-purge-protection", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"network_acls.ip_rules": [{"type": "variable", "name": "allowed_ip_ranges", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_189", "bc_check_id": "BC_AZR_NETWORKING_71", "check_name": "Ensure that Azure Key Vault disables public network access", "check_result": {"result": "PASSED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[71, "resource \"azurerm_key_vault\" \"main\" {\n"], [72, "  name                = local.key_vault_name\n"], [73, "  location            = var.location\n"], [74, "  resource_group_name = var.resource_group_name\n"], [75, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [76, "  sku_name            = \"premium\"\n"], [77, "\n"], [78, "  # Security configuration - OWASP: comprehensive security\n"], [79, "  enabled_for_disk_encryption     = true\n"], [80, "  enabled_for_deployment          = false  # OWASP: disable unnecessary features\n"], [81, "  enabled_for_template_deployment = false  # OWASP: disable unnecessary features\n"], [82, "  purge_protection_enabled        = true   # OWASP: prevent accidental deletion\n"], [83, "  soft_delete_retention_days      = 90\n"], [84, "\n"], [85, "  # Network access restrictions - Zero Trust\n"], [86, "  public_network_access_enabled = false\n"], [87, "  network_acls {\n"], [88, "    default_action = \"Deny\"\n"], [89, "    bypass         = \"AzureServices\"\n"], [90, "    ip_rules       = var.allowed_ip_ranges\n"], [91, "    virtual_network_subnet_ids = []\n"], [92, "  }\n"], [93, "\n"], [94, "  # RBAC for fine-grained access control\n"], [95, "  enable_rbac_authorization = true\n"], [96, "\n"], [97, "  tags = merge(var.common_tags, {\n"], [98, "    Service = \"KeyVault\"\n"], [99, "    Purpose = \"SecretsManagement\"\n"], [100, "  })\n"], [101, "\n"], [102, "  lifecycle {\n"], [103, "    prevent_destroy = true\n"], [104, "  }\n"], [105, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [71, 105], "resource": "module.management.azurerm_key_vault.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyVaultDisablesPublicNetworkAccess", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "KeyVault", "Purpose": "SecretsManagement"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-189", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"network_acls.ip_rules": [{"type": "variable", "name": "allowed_ip_ranges", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_3", "bc_check_id": "BC_AZR_GENERAL_117", "check_name": "Ensure that 'enable_https_traffic_only' is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_https_traffic_only"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountsTransportEncryption", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-3", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_44", "bc_check_id": "BC_AZR_STORAGE_2", "check_name": "Ensure Storage Account is using the latest version of TLS encryption", "check_result": {"result": "PASSED", "evaluated_keys": ["min_tls_version"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountMinimumTlsVersion", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_206", "bc_check_id": "BC_AZR_GENERAL_111", "check_name": "Ensure that Storage Accounts use replication", "check_result": {"result": "PASSED", "evaluated_keys": ["account_replication_type"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountsUseReplication", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-206", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_36", "bc_check_id": "BC_AZR_NETWORKING_16", "check_name": "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountAzureServicesAccessEnabled", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_244", "bc_check_id": "BC_AZR_GENERAL_148", "check_name": "Avoid the use of local users for Azure Storage unless necessary", "check_result": {"result": "PASSED", "evaluated_keys": ["local_user_enabled"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageLocalUsers", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-244", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_59", "bc_check_id": "BC_AZR_NETWORKING_18", "check_name": "Ensure that Storage accounts disallow public access", "check_result": {"result": "PASSED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountDisablePublicAccess", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_190", "bc_check_id": "BC_AZR_NETWORKING_72", "check_name": "Ensure that Storage blobs restrict public access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow_nested_items_to_be_public"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageBlobRestrictPublicAccess", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-190", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_182", "bc_check_id": "BC_AZR_NETWORKING_68", "check_name": "Ensure that VNET has at least 2 connected DNS Endpoints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[36, "resource \"azurerm_virtual_network\" \"hub\" {\n"], [37, "  name                = \"${var.naming_prefix}-hub-vnet\"\n"], [38, "  address_space       = [var.hub_vnet_cidr]\n"], [39, "  location            = var.location\n"], [40, "  resource_group_name = var.network_resource_group_name\n"], [41, "\n"], [42, "  tags = merge(var.common_tags, {\n"], [43, "    Service = \"Network\"\n"], [44, "    Type    = \"Hub\"\n"], [45, "  })\n"], [46, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [36, 46], "resource": "module.network.azurerm_virtual_network.hub", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VnetSingleDNSServer", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Network", "Type": "Hub"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [90, 117], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-182", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "address_space": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "hub_vnet_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_183", "bc_check_id": "BC_AZR_NETWORKING_69", "check_name": "Ensure that VNET uses local DNS addresses", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[36, "resource \"azurerm_virtual_network\" \"hub\" {\n"], [37, "  name                = \"${var.naming_prefix}-hub-vnet\"\n"], [38, "  address_space       = [var.hub_vnet_cidr]\n"], [39, "  location            = var.location\n"], [40, "  resource_group_name = var.network_resource_group_name\n"], [41, "\n"], [42, "  tags = merge(var.common_tags, {\n"], [43, "    Service = \"Network\"\n"], [44, "    Type    = \"Hub\"\n"], [45, "  })\n"], [46, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [36, 46], "resource": "module.network.azurerm_virtual_network.hub", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VnetLocalDNS", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Network", "Type": "Hub"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [90, 117], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-183", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "address_space": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "hub_vnet_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_182", "bc_check_id": "BC_AZR_NETWORKING_68", "check_name": "Ensure that VNET has at least 2 connected DNS Endpoints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[80, "resource \"azurerm_virtual_network\" \"aks\" {\n"], [81, "  name                = \"${var.naming_prefix}-aks-vnet\"\n"], [82, "  address_space       = [var.aks_vnet_cidr]\n"], [83, "  location            = var.location\n"], [84, "  resource_group_name = var.network_resource_group_name\n"], [85, "\n"], [86, "  tags = merge(var.common_tags, {\n"], [87, "    Service = \"Network\"\n"], [88, "    Type    = \"AKSSpoke\"\n"], [89, "  })\n"], [90, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [80, 90], "resource": "module.network.azurerm_virtual_network.aks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VnetSingleDNSServer", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Network", "Type": "AKSSpoke"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [90, 117], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-182", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"location": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "address_space": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "aks_vnet_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_183", "bc_check_id": "BC_AZR_NETWORKING_69", "check_name": "Ensure that VNET uses local DNS addresses", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[80, "resource \"azurerm_virtual_network\" \"aks\" {\n"], [81, "  name                = \"${var.naming_prefix}-aks-vnet\"\n"], [82, "  address_space       = [var.aks_vnet_cidr]\n"], [83, "  location            = var.location\n"], [84, "  resource_group_name = var.network_resource_group_name\n"], [85, "\n"], [86, "  tags = merge(var.common_tags, {\n"], [87, "    Service = \"Network\"\n"], [88, "    Type    = \"AKSSpoke\"\n"], [89, "  })\n"], [90, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [80, 90], "resource": "module.network.azurerm_virtual_network.aks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VnetLocalDNS", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Network", "Type": "AKSSpoke"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [90, 117], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-183", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"location": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "address_space": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "aks_vnet_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_182", "bc_check_id": "BC_AZR_NETWORKING_68", "check_name": "Ensure that VNET has at least 2 connected DNS Endpoints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[117, "resource \"azurerm_virtual_network\" \"cicd\" {\n"], [118, "  name                = \"${var.naming_prefix}-cicd-vnet\"\n"], [119, "  address_space       = [var.cicd_vnet_cidr]\n"], [120, "  location            = var.location\n"], [121, "  resource_group_name = var.network_resource_group_name\n"], [122, "\n"], [123, "  tags = merge(var.common_tags, {\n"], [124, "    Service = \"Network\"\n"], [125, "    Type    = \"CICDSpoke\"\n"], [126, "  })\n"], [127, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [117, 127], "resource": "module.network.azurerm_virtual_network.cicd", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VnetSingleDNSServer", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Network", "Type": "CICDSpoke"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [90, 117], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-182", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "location": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "address_space": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "cicd_vnet_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_183", "bc_check_id": "BC_AZR_NETWORKING_69", "check_name": "Ensure that VNET uses local DNS addresses", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[117, "resource \"azurerm_virtual_network\" \"cicd\" {\n"], [118, "  name                = \"${var.naming_prefix}-cicd-vnet\"\n"], [119, "  address_space       = [var.cicd_vnet_cidr]\n"], [120, "  location            = var.location\n"], [121, "  resource_group_name = var.network_resource_group_name\n"], [122, "\n"], [123, "  tags = merge(var.common_tags, {\n"], [124, "    Service = \"Network\"\n"], [125, "    Type    = \"CICDSpoke\"\n"], [126, "  })\n"], [127, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [117, 127], "resource": "module.network.azurerm_virtual_network.cicd", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VnetLocalDNS", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Network", "Type": "CICDSpoke"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [90, 117], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-183", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "location": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "address_space": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "cicd_vnet_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_32", "bc_check_id": "BC_AZR_GENERAL_125", "check_name": "Ensure private endpoint is configured to key vault", "check_result": {"result": "PASSED", "entity": {"azurerm_key_vault": {"main": {"__end_line__": 105, "__start_line__": 71, "enable_rbac_authorization": [true], "enabled_for_deployment": [false], "enabled_for_disk_encryption": [true], "enabled_for_template_deployment": [false], "lifecycle": [{"prevent_destroy": [true]}], "location": ["East US 2"], "name": ["${replace(${var.company_prefix}-${var.environment}, \"-\", \"\")}kv${random_string.keyvault_suffix.result}"], "network_acls": [{"bypass": ["AzureServices"], "default_action": ["Deny"], "ip_rules": [], "virtual_network_subnet_ids": [[]]}], "public_network_access_enabled": [false], "purge_protection_enabled": [true], "resource_group_name": ["${var.company_prefix}-${var.environment}-management-rg"], "sku_name": ["premium"], "soft_delete_retention_days": [90], "tags": [{"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "KeyVault", "Purpose": "SecretsManagement"}], "tenant_id": ["data.azurerm_client_config.current.tenant_id"], "__address__": "module.management.azurerm_key_vault.main", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[71, "resource \"azurerm_key_vault\" \"main\" {\n"], [72, "  name                = local.key_vault_name\n"], [73, "  location            = var.location\n"], [74, "  resource_group_name = var.resource_group_name\n"], [75, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [76, "  sku_name            = \"premium\"\n"], [77, "\n"], [78, "  # Security configuration - OWASP: comprehensive security\n"], [79, "  enabled_for_disk_encryption     = true\n"], [80, "  enabled_for_deployment          = false  # OWASP: disable unnecessary features\n"], [81, "  enabled_for_template_deployment = false  # OWASP: disable unnecessary features\n"], [82, "  purge_protection_enabled        = true   # OWASP: prevent accidental deletion\n"], [83, "  soft_delete_retention_days      = 90\n"], [84, "\n"], [85, "  # Network access restrictions - Zero Trust\n"], [86, "  public_network_access_enabled = false\n"], [87, "  network_acls {\n"], [88, "    default_action = \"Deny\"\n"], [89, "    bypass         = \"AzureServices\"\n"], [90, "    ip_rules       = var.allowed_ip_ranges\n"], [91, "    virtual_network_subnet_ids = []\n"], [92, "  }\n"], [93, "\n"], [94, "  # RBAC for fine-grained access control\n"], [95, "  enable_rbac_authorization = true\n"], [96, "\n"], [97, "  tags = merge(var.common_tags, {\n"], [98, "    Service = \"KeyVault\"\n"], [99, "    Purpose = \"SecretsManagement\"\n"], [100, "  })\n"], [101, "\n"], [102, "  lifecycle {\n"], [103, "    prevent_destroy = true\n"], [104, "  }\n"], [105, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [71, 105], "resource": "module.management.azurerm_key_vault.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "KeyVault", "Purpose": "SecretsManagement"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-32", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"network_acls.ip_rules": [{"type": "variable", "name": "allowed_ip_ranges", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_47", "bc_check_id": "BC_AZR_IAM_22", "check_name": "Ensure storage account is configured without blob anonymous access", "check_result": {"result": "PASSED", "entity": {"azurerm_storage_account": {"compliance[0]": {"__end_line__": 297, "__start_line__": 265, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "blob_properties": [{"container_delete_retention_policy": [{"days": [90]}], "delete_retention_policy": [{"days": [90]}], "versioning_enabled": [true]}], "https_traffic_only_enabled": [true], "infrastructure_encryption_enabled": [true], "location": ["East US 2"], "min_tls_version": ["TLS1_2"], "name": ["${replace(${var.company_prefix}-${var.environment}, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}"], "public_network_access_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-management-rg"], "tags": [{"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}], "__address__": "module.management.azurerm_storage_account.compliance[0]", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["allow_nested_items_to_be_public"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-47", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_38", "bc_check_id": "BC_AZR_GENERAL_128", "check_name": "Ensure soft-delete is enabled on Azure storage account", "check_result": {"result": "PASSED", "entity": {"azurerm_storage_account": {"compliance[0]": {"__end_line__": 297, "__start_line__": 265, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "blob_properties": [{"container_delete_retention_policy": [{"days": [90]}], "delete_retention_policy": [{"days": [90]}], "versioning_enabled": [true]}], "https_traffic_only_enabled": [true], "infrastructure_encryption_enabled": [true], "location": ["East US 2"], "min_tls_version": ["TLS1_2"], "name": ["${replace(${var.company_prefix}-${var.environment}, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}"], "public_network_access_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-management-rg"], "tags": [{"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}], "__address__": "module.management.azurerm_storage_account.compliance[0]", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["blob_properties/delete_retention_policy/days", "blob_properties/delete_retention_policy", "account_kind"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-38", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_30", "bc_check_id": "BC_AZR_GENERAL_123", "check_name": "Ensure Azure Container Registry (ACR) has HTTPS enabled for webhook", "check_result": {"result": "PASSED", "entity": {"azurerm_container_registry_webhook": {"security_webhook": {"__end_line__": 227, "__start_line__": 205, "actions": [["delete", "push", "quarantine"]], "custom_headers": [{"X-ACR-Source": "zero-trust-acr", "X-Security-Level": "high"}], "location": ["East US 2"], "name": ["${var.company_prefix}-${var.environment}-security-webhook"], "registry_name": ["module.acr.resource.name"], "resource_group_name": ["${var.company_prefix}-${var.environment}-acr-rg"], "scope": ["*"], "service_uri": ["https://example.com/webhook"], "status": ["enabled"], "tags": [{"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "${var.cost_center}", "Environment": "var.environment", "LastModified": "${timestamp()}", "ManagedBy": "Terraform", "Owner": "${var.owner}", "Project": "Zero-Trust-ACR"}], "__address__": "module.acr.azurerm_container_registry_webhook.security_webhook", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["service_uri"]}, "code_block": [[205, "resource \"azurerm_container_registry_webhook\" \"security_webhook\" {\n"], [206, "  name                = \"${var.naming_prefix}-security-webhook\"\n"], [207, "  resource_group_name = var.resource_group_name\n"], [208, "  registry_name       = module.acr.resource.name\n"], [209, "  location            = var.location\n"], [210, "\n"], [211, "  service_uri = var.security_webhook_url\n"], [212, "  status      = \"enabled\"\n"], [213, "  scope       = \"*\"\n"], [214, "\n"], [215, "  actions = [\n"], [216, "    \"push\",\n"], [217, "    \"delete\",\n"], [218, "    \"quarantine\"\n"], [219, "  ]\n"], [220, "\n"], [221, "  custom_headers = {\n"], [222, "    \"X-ACR-Source\" = \"zero-trust-acr\"\n"], [223, "    \"X-Security-Level\" = \"high\"\n"], [224, "  }\n"], [225, "\n"], [226, "  tags = var.common_tags\n"], [227, "}\n"]], "file_path": "/terraform/modules/acr/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "repo_file_path": "/terraform/modules/acr/main.tf", "file_line_range": [205, 227], "resource": "module.acr.azurerm_container_registry_webhook.security_webhook", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "${var.cost_center}", "Environment": "var.environment", "LastModified": "${timestamp()}", "ManagedBy": "Terraform", "Owner": "${var.owner}", "Project": "Zero-Trust-ACR"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-30", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "breadcrumbs": {"service_uri": [{"type": "variable", "name": "security_webhook_url", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "location": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 8, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "PASSED", "entity": {"azurerm_subnet": {"hub_gateway": {"__end_line__": 61, "__start_line__": 56, "address_prefixes": [["10.0.2.0/24"]], "name": ["GatewaySubnet"], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-hub-vnet"], "__address__": "module.network.azurerm_subnet.hub_gateway", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[56, "resource \"azurerm_subnet\" \"hub_gateway\" {\n"], [57, "  name                 = \"GatewaySubnet\"\n"], [58, "  resource_group_name  = var.network_resource_group_name\n"], [59, "  virtual_network_name = azurerm_virtual_network.hub.name\n"], [60, "  address_prefixes     = [local.subnets.hub_gateway]\n"], [61, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [56, 61], "resource": "module.network.azurerm_subnet.hub_gateway", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "PASSED", "entity": {"azurerm_subnet": {"hub_firewall": {"__end_line__": 54, "__start_line__": 49, "address_prefixes": [["10.0.1.0/24"]], "name": ["AzureFirewallSubnet"], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-hub-vnet"], "__address__": "module.network.azurerm_subnet.hub_firewall", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[49, "resource \"azurerm_subnet\" \"hub_firewall\" {\n"], [50, "  name                 = \"AzureFirewallSubnet\"\n"], [51, "  resource_group_name  = var.network_resource_group_name\n"], [52, "  virtual_network_name = azurerm_virtual_network.hub.name\n"], [53, "  address_prefixes     = [local.subnets.hub_firewall]\n"], [54, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [49, 54], "resource": "module.network.azurerm_subnet.hub_firewall", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}], "failed_checks": [{"check_id": "CKV_TF_1", "bc_check_id": "BC_CROSS_1", "check_name": "Ensure Terraform module sources use a commit hash", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[32, "module \"acr\" {\n"], [33, "  source  = \"Azure/avm-res-containerregistry-registry/azurerm\"\n"], [34, "  version = \"~> 0.5.0\"\n"], [35, "\n"], [36, "  # Basic configuration\n"], [37, "  name                = local.acr_name\n"], [38, "  location            = var.location\n"], [39, "  resource_group_name = var.resource_group_name\n"], [40, "  sku                 = \"Premium\" # Premium required for security features\n"], [41, "\n"], [42, "  # Security configuration - OWASP compliant\n"], [43, "  public_network_access_enabled = false # Zero Trust: no public access\n"], [44, "  admin_enabled                 = false # OWASP: avoid default credentials\n"], [45, "  export_policy_enabled         = false # Prevent unauthorized export\n"], [46, "  zone_redundancy_enabled       = var.enable_zone_redundancy\n"], [47, "\n"], [48, "  # Content trust and security policies\n"], [49, "  enable_trust_policy       = true  # OWASP: secure content verification\n"], [50, "  quarantine_policy_enabled = true  # OWASP: prevent malicious content\n"], [51, "  retention_policy_in_days  = var.retention_days_untagged\n"], [52, "\n"], [53, "  # Network security\n"], [54, "  network_rule_set = {\n"], [55, "    default_action = \"Deny\"\n"], [56, "    ip_rule        = [] # No public IP access for Zero Trust\n"], [57, "  }\n"], [58, "  network_rule_bypass_option = \"AzureServices\"\n"], [59, "\n"], [60, "  # Data endpoint for performance\n"], [61, "  data_endpoint_enabled = true\n"], [62, "\n"], [63, "  # Customer-managed encryption\n"], [64, "  customer_managed_key = var.cmk_enabled ? {\n"], [65, "    key_vault_resource_id = var.key_vault_id\n"], [66, "    key_name              = \"acr-encryption-key\"\n"], [67, "    user_assigned_identity = {\n"], [68, "      resource_id = azurerm_user_assigned_identity.acr_identity.id\n"], [69, "    }\n"], [70, "  } : null\n"], [71, "\n"], [72, "  # Managed identity for secure operations\n"], [73, "  managed_identities = {\n"], [74, "    system_assigned = true\n"], [75, "    user_assigned_resource_ids = var.cmk_enabled ? [\n"], [76, "      azurerm_user_assigned_identity.acr_identity.id\n"], [77, "    ] : []\n"], [78, "  }\n"], [79, "\n"], [80, "  # Geo-replication for high availability\n"], [81, "  georeplications = [\n"], [82, "    for location in var.geo_replication_locations : {\n"], [83, "      location                  = location\n"], [84, "      regional_endpoint_enabled = true\n"], [85, "      zone_redundancy_enabled   = true\n"], [86, "    }\n"], [87, "  ]\n"], [88, "\n"], [89, "  # Private endpoint configuration\n"], [90, "  private_endpoints = {\n"], [91, "    primary = {\n"], [92, "      name                          = \"${var.naming_prefix}-acr-pe\"\n"], [93, "      subnet_resource_id            = var.hub_private_endpoints_subnet_id\n"], [94, "      private_dns_zone_resource_ids = [var.acr_private_dns_zone_id]\n"], [95, "\n"], [96, "      # Network interface configuration\n"], [97, "      network_interface_name = \"${var.naming_prefix}-acr-pe-nic\"\n"], [98, "\n"], [99, "      tags = var.common_tags\n"], [100, "    }\n"], [101, "  }\n"], [102, "\n"], [103, "  # Comprehensive diagnostic settings for audit compliance\n"], [104, "  diagnostic_settings = {\n"], [105, "    audit = {\n"], [106, "      name                       = \"acr-audit-diagnostics\"\n"], [107, "      workspace_resource_id      = var.log_analytics_workspace_id\n"], [108, "      log_categories             = []\n"], [109, "      log_groups                = [\"audit\", \"allLogs\"]\n"], [110, "      metric_categories         = [\"AllMetrics\"]\n"], [111, "      log_analytics_destination_type = \"Dedicated\"\n"], [112, "    }\n"], [113, "  }\n"], [114, "\n"], [115, "  # Scope maps for fine-grained access control - OWASP: secure access management\n"], [116, "  scope_maps = {\n"], [117, "    readonly = {\n"], [118, "      name        = \"readonly-scope\"\n"], [119, "      description = \"Read-only access for monitoring and compliance\"\n"], [120, "      actions = [\n"], [121, "        \"repositories/*/content/read\",\n"], [122, "        \"repositories/*/metadata/read\"\n"], [123, "      ]\n"], [124, "    }\n"], [125, "\n"], [126, "    cicd_build = {\n"], [127, "      name        = \"cicd-build-scope\"\n"], [128, "      description = \"CI/CD pipeline access for secure image building\"\n"], [129, "      actions = [\n"], [130, "        \"repositories/*/content/read\",\n"], [131, "        \"repositories/*/content/write\",\n"], [132, "        \"repositories/*/metadata/read\",\n"], [133, "        \"repositories/*/metadata/write\"\n"], [134, "      ]\n"], [135, "\n"], [136, "      registry_tokens = {\n"], [137, "        cicd_token = {\n"], [138, "          name    = \"cicd-secure-token\"\n"], [139, "          enabled = true\n"], [140, "          passwords = {\n"], [141, "            password1 = {\n"], [142, "              expiry = timeadd(timestamp(), \"2160h\") # 90 days\n"], [143, "            }\n"], [144, "          }\n"], [145, "        }\n"], [146, "      }\n"], [147, "    }\n"], [148, "\n"], [149, "    production_deploy = {\n"], [150, "      name        = \"production-deploy-scope\"\n"], [151, "      description = \"Production deployment access with pull-only permissions\"\n"], [152, "      actions = [\n"], [153, "        \"repositories/*/content/read\",\n"], [154, "        \"repositories/*/metadata/read\"\n"], [155, "      ]\n"], [156, "    }\n"], [157, "  }\n"], [158, "\n"], [159, "  # Role assignments for secure access - OWASP: principle of least privilege\n"], [160, "  role_assignments = {\n"], [161, "    acr_pull_aks = {\n"], [162, "      role_definition_id_or_name = \"AcrPull\"\n"], [163, "      principal_id               = var.aks_kubelet_identity_object_id\n"], [164, "      description               = \"AKS kubelet identity pull access\"\n"], [165, "      principal_type            = \"ServicePrincipal\"\n"], [166, "    }\n"], [167, "  }\n"], [168, "\n"], [169, "  # Tags\n"], [170, "  tags = merge(var.common_tags, {\n"], [171, "    Service     = \"ContainerRegistry\"\n"], [172, "    Purpose     = \"ZeroTrust\"\n"], [173, "    Compliance  = \"OWASP-Top10\"\n"], [174, "    SecurityLevel = \"High\"\n"], [175, "  })\n"], [176, "}\n"]], "file_path": "/terraform/modules/acr/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "repo_file_path": "/terraform/modules/acr/main.tf", "file_line_range": [32, 176], "resource": "module.acr.acr", "evaluations": null, "check_class": "checkov.terraform.checks.module.generic.RevisionHash", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [134, 152], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-git-url-with-commit-hash-revision", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "breadcrumbs": {"role_assignments.acr_pull_aks.principal_id": [{"type": "variable", "name": "aks_kubelet_identity_object_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "role_assignments.acr_pull_aks": [{"type": "variable", "name": "aks_kubelet_identity_object_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "managed_identities.user_assigned_resource_ids": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "cmk_enabled", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "diagnostic_settings.audit.workspace_resource_id": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "log_analytics_workspace_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "diagnostic_settings.audit": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "log_analytics_workspace_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary.private_dns_zone_resource_ids": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "acr_private_dns_zone_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "location": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary.subnet_resource_id": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "hub_private_endpoints_subnet_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "zone_redundancy_enabled": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "enable_zone_redundancy", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "retention_policy_in_days": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "retention_days_untagged", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "georeplications": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "geo_replication_locations", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "customer_managed_key": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "cmk_enabled", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary.tags": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}], "private_endpoints.primary.name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "private_endpoints.primary.network_interface_name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "name": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/variables.tf", "module_connection": false}, {"type": "locals", "name": "acr_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/acr/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "acr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 8, "source_module_object": null}]}}, {"check_id": "CKV_TF_1", "bc_check_id": "BC_CROSS_1", "check_name": "Ensure Terraform module sources use a commit hash", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[21, "module \"aks_production\" {\n"], [22, "  source  = \"Azure/avm-ptn-aks-production/azurerm\"\n"], [23, "  version = \"~> 0.5.0\"\n"], [24, "\n"], [25, "  # Basic configuration\n"], [26, "  name                = \"${var.naming_prefix}-aks\"\n"], [27, "  location            = var.location\n"], [28, "  resource_group_name = var.resource_group_name\n"], [29, "\n"], [30, "  # Kubernetes configuration\n"], [31, "  kubernetes_version = var.kubernetes_version\n"], [32, "\n"], [33, "  # Network configuration for Zero Trust\n"], [34, "  network = {\n"], [35, "    node_subnet_id = var.system_pool_subnet_id\n"], [36, "    pod_cidr       = var.pod_cidr\n"], [37, "    service_cidr   = var.service_cidr\n"], [38, "    dns_service_ip = var.dns_service_ip\n"], [39, "  }\n"], [40, "\n"], [41, "  # Private cluster configuration - OWASP: secure network access\n"], [42, "  private_dns_zone_id         = var.private_dns_zone_id\n"], [43, "  private_dns_zone_id_enabled = true\n"], [44, "\n"], [45, "  # Network policy for Zero Trust micro-segmentation\n"], [46, "  network_policy = var.enable_network_policy\n"], [47, "\n"], [48, "  # Outbound traffic control\n"], [49, "  outbound_type = var.outbound_type\n"], [50, "\n"], [51, "  # ACR integration with private endpoint\n"], [52, "  acr = var.acr_id != \"\" ? {\n"], [53, "    name                          = split(\"/\", var.acr_id)[8] # Extract ACR name from resource ID\n"], [54, "    subnet_resource_id            = var.private_link_subnet_id\n"], [55, "    private_dns_zone_resource_ids = [var.acr_private_dns_zone_id]\n"], [56, "    zone_redundancy_enabled       = var.enable_zone_redundancy\n"], [57, "  } : null\n"], [58, "\n"], [59, "  # Managed identity configuration\n"], [60, "  managed_identities = {\n"], [61, "    user_assigned_resource_ids = var.user_assigned_identity_ids\n"], [62, "  }\n"], [63, "\n"], [64, "  # Azure AD integration - OWASP: secure authentication\n"], [65, "  rbac_aad_azure_rbac_enabled     = var.enable_azure_rbac\n"], [66, "  rbac_aad_tenant_id              = var.aad_tenant_id\n"], [67, "  rbac_aad_admin_group_object_ids = var.aad_admin_group_object_ids\n"], [68, "\n"], [69, "  # Default node pool configuration\n"], [70, "  default_node_pool_vm_sku = var.node_vm_size\n"], [71, "  os_sku                   = var.os_sku\n"], [72, "  os_disk_type            = var.os_disk_type\n"], [73, "\n"], [74, "  # Additional node pools for workload separation\n"], [75, "  node_pools = {\n"], [76, "    # User workload pool\n"], [77, "    user_pool = {\n"], [78, "      name                 = \"userpool\"\n"], [79, "      vm_size              = var.node_vm_size\n"], [80, "      orchestrator_version = var.kubernetes_version\n"], [81, "      max_count           = var.user_node_count_max\n"], [82, "      min_count           = var.user_node_count_min\n"], [83, "      os_sku              = var.os_sku\n"], [84, "      os_disk_type        = var.os_disk_type\n"], [85, "      mode                = \"User\"\n"], [86, "      labels = merge(var.node_labels, {\n"], [87, "        \"nodepool-type\" = \"user\"\n"], [88, "        \"workload\"      = \"general\"\n"], [89, "      })\n"], [90, "      tags = merge(var.common_tags, {\n"], [91, "        NodePool = \"User\"\n"], [92, "        Purpose  = \"WorkloadNodes\"\n"], [93, "      })\n"], [94, "    }\n"], [95, "\n"], [96, "    # GPU pool for ML workloads (if enabled)\n"], [97, "    gpu_pool = var.enable_gpu_nodes ? {\n"], [98, "      name                 = \"gpupool\"\n"], [99, "      vm_size              = var.gpu_vm_size\n"], [100, "      orchestrator_version = var.kubernetes_version\n"], [101, "      max_count           = var.gpu_node_count_max\n"], [102, "      min_count           = var.gpu_node_count_min\n"], [103, "      os_sku              = var.os_sku\n"], [104, "      os_disk_type        = var.os_disk_type\n"], [105, "      mode                = \"User\"\n"], [106, "      labels = merge(var.node_labels, {\n"], [107, "        \"nodepool-type\"    = \"gpu\"\n"], [108, "        \"workload\"         = \"ml\"\n"], [109, "        \"accelerator\"      = \"nvidia-gpu\"\n"], [110, "      })\n"], [111, "      tags = merge(var.common_tags, {\n"], [112, "        NodePool = \"GPU\"\n"], [113, "        Purpose  = \"MLWorkloads\"\n"], [114, "      })\n"], [115, "    } : null\n"], [116, "  }\n"], [117, "\n"], [118, "  # Prometheus monitoring configuration\n"], [119, "  monitor_metrics = var.enable_prometheus ? {\n"], [120, "    annotations_allowed = \"prometheus.io/scrape,prometheus.io/port,prometheus.io/path\"\n"], [121, "    labels_allowed      = \"app.kubernetes.io/name,app.kubernetes.io/instance\"\n"], [122, "  } : null\n"], [123, "\n"], [124, "  # Security tags\n"], [125, "  tags = merge(var.common_tags, {\n"], [126, "    Service       = \"Kubernetes\"\n"], [127, "    Purpose       = \"ZeroTrust\"\n"], [128, "    Compliance    = \"OWASP-Top10\"\n"], [129, "    SecurityLevel = \"High\"\n"], [130, "    NetworkPolicy = var.enable_network_policy\n"], [131, "    PrivateCluster = \"true\"\n"], [132, "  })\n"], [133, "}\n"]], "file_path": "/terraform/modules/aks/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "repo_file_path": "/terraform/modules/aks/main.tf", "file_line_range": [21, 133], "resource": "module.aks.aks_production", "evaluations": null, "check_class": "checkov.terraform.checks.module.generic.RevisionHash", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [155, 204], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-git-url-with-commit-hash-revision", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "breadcrumbs": {"network.pod_cidr": [{"type": "variable", "name": "pod_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "network.service_cidr": [{"type": "variable", "name": "service_cidr", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "network.dns_service_ip": [{"type": "variable", "name": "dns_service_ip", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "os_sku": [{"type": "variable", "name": "os_sku", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.gpu_pool": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "kubernetes_version", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.os_sku": [{"type": "variable", "name": "os_sku", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "user_node_count_max", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "os_disk_type": [{"type": "variable", "name": "os_disk_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.os_disk_type": [{"type": "variable", "name": "os_disk_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "rbac_aad_azure_rbac_enabled": [{"type": "variable", "name": "enable_azure_rbac", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "managed_identities.user_assigned_resource_ids": [{"type": "variable", "name": "user_assigned_identity_ids", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "acr": [{"type": "variable", "name": "enable_zone_redundancy", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.labels": [{"type": "variable", "name": "node_labels", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "private_dns_zone_id": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_dns_zone_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.orchestrator_version": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "kubernetes_version", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "enable_network_policy", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "network.node_subnet_id": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "system_pool_subnet_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.min_count": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "user_node_count_min", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "kubernetes_version": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "kubernetes_version", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "monitor_metrics": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "enable_prometheus", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "outbound_type": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "outbound_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "rbac_aad_tenant_id": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "aad_tenant_id", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "default_node_pool_vm_sku": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_vm_size", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_network_security_group.aks_nsg", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/main.tf", "module_connection": false}], "node_pools.user_pool.tags": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.vm_size": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_vm_size", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "rbac_aad_admin_group_object_ids": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "aad_admin_group_object_ids", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "network_policy": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "enable_network_policy", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "node_pools.user_pool.max_count": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "user_node_count_max", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/aks/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 9, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_112", "bc_check_id": "BC_AZR_GENERAL_17", "check_name": "Ensure that key vault key is backed by HSM", "check_result": {"result": "FAILED", "evaluated_keys": ["key_type"]}, "code_block": [[204, "resource \"azurerm_key_vault_key\" \"acr_encryption\" {\n"], [205, "  name         = \"acr-encryption-key\"\n"], [206, "  key_vault_id = azurerm_key_vault.main.id\n"], [207, "  key_type     = \"RSA\"\n"], [208, "  key_size     = 2048\n"], [209, "\n"], [210, "  key_opts = [\n"], [211, "    \"decrypt\",\n"], [212, "    \"encrypt\",\n"], [213, "    \"sign\",\n"], [214, "    \"unwrapKey\",\n"], [215, "    \"verify\",\n"], [216, "    \"wrapKey\",\n"], [217, "  ]\n"], [218, "\n"], [219, "  tags = merge(var.common_tags, {\n"], [220, "    Purpose = \"ACREncryption\"\n"], [221, "  })\n"], [222, "\n"], [223, "  depends_on = [azurerm_key_vault.main]\n"], [224, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [204, 224], "resource": "module.management.azurerm_key_vault_key.acr_encryption", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyBackedByHSM", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Purpose": "ACREncryption"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-key-is-backed-by-hsm", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_40", "bc_check_id": "BC_AZR_GENERAL_10", "check_name": "Ensure that the expiration date is set on all keys", "check_result": {"result": "FAILED", "evaluated_keys": ["expiration_date"]}, "code_block": [[204, "resource \"azurerm_key_vault_key\" \"acr_encryption\" {\n"], [205, "  name         = \"acr-encryption-key\"\n"], [206, "  key_vault_id = azurerm_key_vault.main.id\n"], [207, "  key_type     = \"RSA\"\n"], [208, "  key_size     = 2048\n"], [209, "\n"], [210, "  key_opts = [\n"], [211, "    \"decrypt\",\n"], [212, "    \"encrypt\",\n"], [213, "    \"sign\",\n"], [214, "    \"unwrapKey\",\n"], [215, "    \"verify\",\n"], [216, "    \"wrapKey\",\n"], [217, "  ]\n"], [218, "\n"], [219, "  tags = merge(var.common_tags, {\n"], [220, "    Purpose = \"ACREncryption\"\n"], [221, "  })\n"], [222, "\n"], [223, "  depends_on = [azurerm_key_vault.main]\n"], [224, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [204, 224], "resource": "module.management.azurerm_key_vault_key.acr_encryption", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyExpirationDate", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Purpose": "ACREncryption"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/set-an-expiration-date-on-all-keys", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_112", "bc_check_id": "BC_AZR_GENERAL_17", "check_name": "Ensure that key vault key is backed by HSM", "check_result": {"result": "FAILED", "evaluated_keys": ["key_type"]}, "code_block": [[227, "resource \"azurerm_key_vault_key\" \"content_trust\" {\n"], [228, "  name         = \"acr-content-trust-key\"\n"], [229, "  key_vault_id = azurerm_key_vault.main.id\n"], [230, "  key_type     = \"RSA\"\n"], [231, "  key_size     = 2048\n"], [232, "\n"], [233, "  key_opts = [\n"], [234, "    \"sign\",\n"], [235, "    \"verify\",\n"], [236, "  ]\n"], [237, "\n"], [238, "  tags = merge(var.common_tags, {\n"], [239, "    Purpose = \"ContentTrust\"\n"], [240, "  })\n"], [241, "\n"], [242, "  depends_on = [azurerm_key_vault.main]\n"], [243, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [227, 243], "resource": "module.management.azurerm_key_vault_key.content_trust", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyBackedByHSM", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Purpose": "ContentTrust"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-key-is-backed-by-hsm", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_40", "bc_check_id": "BC_AZR_GENERAL_10", "check_name": "Ensure that the expiration date is set on all keys", "check_result": {"result": "FAILED", "evaluated_keys": ["expiration_date"]}, "code_block": [[227, "resource \"azurerm_key_vault_key\" \"content_trust\" {\n"], [228, "  name         = \"acr-content-trust-key\"\n"], [229, "  key_vault_id = azurerm_key_vault.main.id\n"], [230, "  key_type     = \"RSA\"\n"], [231, "  key_size     = 2048\n"], [232, "\n"], [233, "  key_opts = [\n"], [234, "    \"sign\",\n"], [235, "    \"verify\",\n"], [236, "  ]\n"], [237, "\n"], [238, "  tags = merge(var.common_tags, {\n"], [239, "    Purpose = \"ContentTrust\"\n"], [240, "  })\n"], [241, "\n"], [242, "  depends_on = [azurerm_key_vault.main]\n"], [243, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [227, 243], "resource": "module.management.azurerm_key_vault_key.content_trust", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyExpirationDate", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Purpose": "ContentTrust"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/set-an-expiration-date-on-all-keys", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV_AZURE_33", "bc_check_id": "BC_AZR_LOGGING_4", "check_name": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "check_result": {"result": "FAILED", "evaluated_keys": ["account_kind"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountLoggingQueueServiceEnabled", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": "/terraform/main.tf", "caller_file_line_range": [120, 131], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_40", "bc_check_id": "BC_AZR_IAM_20", "check_name": "Ensure storage account is not configured with Shared Key authorization", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"compliance[0]": {"__end_line__": 297, "__start_line__": 265, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "blob_properties": [{"container_delete_retention_policy": [{"days": [90]}], "delete_retention_policy": [{"days": [90]}], "versioning_enabled": [true]}], "https_traffic_only_enabled": [true], "infrastructure_encryption_enabled": [true], "location": ["East US 2"], "min_tls_version": ["TLS1_2"], "name": ["${replace(${var.company_prefix}-${var.environment}, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}"], "public_network_access_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-management-rg"], "tags": [{"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}], "__address__": "module.management.azurerm_storage_account.compliance[0]", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["shared_access_key_enabled"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-40", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_41", "bc_check_id": "BC_AZR_IAM_21", "check_name": "Ensure storage account is configured with SAS expiration policy", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"compliance[0]": {"__end_line__": 297, "__start_line__": 265, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "blob_properties": [{"container_delete_retention_policy": [{"days": [90]}], "delete_retention_policy": [{"days": [90]}], "versioning_enabled": [true]}], "https_traffic_only_enabled": [true], "infrastructure_encryption_enabled": [true], "location": ["East US 2"], "min_tls_version": ["TLS1_2"], "name": ["${replace(${var.company_prefix}-${var.environment}, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}"], "public_network_access_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-management-rg"], "tags": [{"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}], "__address__": "module.management.azurerm_storage_account.compliance[0]", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["sas_policy/expiration_period", "shared_access_key_enabled", "sas_policy"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-41", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_33", "bc_check_id": "BC_AZR_GENERAL_126", "check_name": "Ensure storage account is configured with private endpoint", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"compliance[0]": {"__end_line__": 297, "__start_line__": 265, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "blob_properties": [{"container_delete_retention_policy": [{"days": [90]}], "delete_retention_policy": [{"days": [90]}], "versioning_enabled": [true]}], "https_traffic_only_enabled": [true], "infrastructure_encryption_enabled": [true], "location": ["East US 2"], "min_tls_version": ["TLS1_2"], "name": ["${replace(${var.company_prefix}-${var.environment}, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}"], "public_network_access_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-management-rg"], "tags": [{"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}], "__address__": "module.management.azurerm_storage_account.compliance[0]", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-33", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_1", "bc_check_id": "BC_AZR_GENERAL_32", "check_name": "Ensure storage for critical data are encrypted with Customer Managed Key", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"compliance[0]": {"__end_line__": 297, "__start_line__": 265, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "blob_properties": [{"container_delete_retention_policy": [{"days": [90]}], "delete_retention_policy": [{"days": [90]}], "versioning_enabled": [true]}], "https_traffic_only_enabled": [true], "infrastructure_encryption_enabled": [true], "location": ["East US 2"], "min_tls_version": ["TLS1_2"], "name": ["${replace(${var.company_prefix}-${var.environment}, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}"], "public_network_access_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-management-rg"], "tags": [{"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}], "__address__": "module.management.azurerm_storage_account.compliance[0]", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "customer_managed_key/key_vault_key_id"]}, "code_block": [[265, "resource \"azurerm_storage_account\" \"compliance\" {\n"], [266, "  count = var.enable_compliance_storage ? 1 : 0\n"], [267, "\n"], [268, "  name                = \"${replace(var.naming_prefix, \"-\", \"\")}compliance${random_string.storage_suffix[0].result}\"\n"], [269, "  resource_group_name = var.resource_group_name\n"], [270, "  location            = var.location\n"], [271, "  account_tier        = \"Standard\"\n"], [272, "  account_replication_type = var.storage_replication_type\n"], [273, "\n"], [274, "  # Security configuration - OWASP compliance\n"], [275, "  min_tls_version                 = \"TLS1_2\"\n"], [276, "  allow_nested_items_to_be_public = false\n"], [277, "  public_network_access_enabled   = false\n"], [278, "  https_traffic_only_enabled      = true\n"], [279, "\n"], [280, "  # Advanced security features\n"], [281, "  infrastructure_encryption_enabled = true\n"], [282, "\n"], [283, "  blob_properties {\n"], [284, "    versioning_enabled  = true\n"], [285, "    delete_retention_policy {\n"], [286, "      days = var.backup_retention_days\n"], [287, "    }\n"], [288, "    container_delete_retention_policy {\n"], [289, "      days = var.backup_retention_days\n"], [290, "    }\n"], [291, "  }\n"], [292, "\n"], [293, "  tags = merge(var.common_tags, {\n"], [294, "    Service = \"Storage\"\n"], [295, "    Purpose = \"ComplianceBackup\"\n"], [296, "  })\n"], [297, "}\n"]], "file_path": "/terraform/modules/management/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "repo_file_path": "/terraform/modules/management/main.tf", "file_line_range": [265, 297], "resource": "module.management.azurerm_storage_account.compliance[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Classification": "Internal", "Compliance": "ISO27001,SOC2,DORA", "CostCenter": "var.cost_center", "Environment": "var.environment", "LastModified": "timestamp()", "ManagedBy": "Terraform", "Owner": "var.owner", "Project": "Zero-Trust-ACR", "Service": "Storage", "Purpose": "ComplianceBackup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "breadcrumbs": {"account_replication_type": [{"type": "variable", "name": "storage_replication_type", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.container_delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy.days": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "blob_properties.delete_retention_policy": [{"type": "variable", "name": "backup_retention_days", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "location", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}, {"type": "locals", "name": "key_vault_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_log_analytics_workspace.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_application_insights.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_key_vault.main", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/main.tf", "module_connection": false}], "resource_group_name": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "common_tags", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/management/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "management", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 7, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"hub_bastion": {"__end_line__": 68, "__start_line__": 63, "address_prefixes": [["10.0.3.0/24"]], "name": ["AzureBastionSubnet"], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-hub-vnet"], "__address__": "module.network.azurerm_subnet.hub_bastion", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[63, "resource \"azurerm_subnet\" \"hub_bastion\" {\n"], [64, "  name                 = \"AzureBastionSubnet\"\n"], [65, "  resource_group_name  = var.network_resource_group_name\n"], [66, "  virtual_network_name = azurerm_virtual_network.hub.name\n"], [67, "  address_prefixes     = [local.subnets.hub_bastion]\n"], [68, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [63, 68], "resource": "module.network.azurerm_subnet.hub_bastion", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"hub_private_endpoints": {"__end_line__": 77, "__start_line__": 70, "address_prefixes": [["10.0.10.0/24"]], "name": ["private-endpoints-subnet"], "private_endpoint_network_policies_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-hub-vnet"], "__address__": "module.network.azurerm_subnet.hub_private_endpoints", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[70, "resource \"azurerm_subnet\" \"hub_private_endpoints\" {\n"], [71, "  name                 = \"private-endpoints-subnet\"\n"], [72, "  resource_group_name  = var.network_resource_group_name\n"], [73, "  virtual_network_name = azurerm_virtual_network.hub.name\n"], [74, "  address_prefixes     = [local.subnets.hub_private_endpoints]\n"], [75, "\n"], [76, "  private_endpoint_network_policies_enabled = false\n"], [77, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [70, 77], "resource": "module.network.azurerm_subnet.hub_private_endpoints", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"aks_system_pool": {"__end_line__": 98, "__start_line__": 93, "address_prefixes": [["10.1.1.0/24"]], "name": ["aks-system-pool-subnet"], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-aks-vnet"], "__address__": "module.network.azurerm_subnet.aks_system_pool", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[93, "resource \"azurerm_subnet\" \"aks_system_pool\" {\n"], [94, "  name                 = \"aks-system-pool-subnet\"\n"], [95, "  resource_group_name  = var.network_resource_group_name\n"], [96, "  virtual_network_name = azurerm_virtual_network.aks.name\n"], [97, "  address_prefixes     = [local.subnets.aks_system_pool]\n"], [98, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [93, 98], "resource": "module.network.azurerm_subnet.aks_system_pool", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"aks_user_pool": {"__end_line__": 105, "__start_line__": 100, "address_prefixes": [["10.1.2.0/24"]], "name": ["aks-user-pool-subnet"], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-aks-vnet"], "__address__": "module.network.azurerm_subnet.aks_user_pool", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[100, "resource \"azurerm_subnet\" \"aks_user_pool\" {\n"], [101, "  name                 = \"aks-user-pool-subnet\"\n"], [102, "  resource_group_name  = var.network_resource_group_name\n"], [103, "  virtual_network_name = azurerm_virtual_network.aks.name\n"], [104, "  address_prefixes     = [local.subnets.aks_user_pool]\n"], [105, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [100, 105], "resource": "module.network.azurerm_subnet.aks_user_pool", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"aks_private_link": {"__end_line__": 114, "__start_line__": 107, "address_prefixes": [["10.1.10.0/24"]], "name": ["aks-private-link-subnet"], "private_endpoint_network_policies_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-aks-vnet"], "__address__": "module.network.azurerm_subnet.aks_private_link", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[107, "resource \"azurerm_subnet\" \"aks_private_link\" {\n"], [108, "  name                 = \"aks-private-link-subnet\"\n"], [109, "  resource_group_name  = var.network_resource_group_name\n"], [110, "  virtual_network_name = azurerm_virtual_network.aks.name\n"], [111, "  address_prefixes     = [local.subnets.aks_private_link]\n"], [112, "\n"], [113, "  private_endpoint_network_policies_enabled = false\n"], [114, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [107, 114], "resource": "module.network.azurerm_subnet.aks_private_link", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"cicd_build_agents": {"__end_line__": 135, "__start_line__": 130, "address_prefixes": [["10.2.1.0/24"]], "name": ["build-agents-subnet"], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-cicd-vnet"], "__address__": "module.network.azurerm_subnet.cicd_build_agents", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[130, "resource \"azurerm_subnet\" \"cicd_build_agents\" {\n"], [131, "  name                 = \"build-agents-subnet\"\n"], [132, "  resource_group_name  = var.network_resource_group_name\n"], [133, "  virtual_network_name = azurerm_virtual_network.cicd.name\n"], [134, "  address_prefixes     = [local.subnets.cicd_build_agents]\n"], [135, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [130, 135], "resource": "module.network.azurerm_subnet.cicd_build_agents", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"cicd_private_endpoints": {"__end_line__": 144, "__start_line__": 137, "address_prefixes": [["10.2.10.0/24"]], "name": ["cicd-private-endpoints-subnet"], "private_endpoint_network_policies_enabled": [false], "resource_group_name": ["${var.company_prefix}-${var.environment}-network-rg"], "virtual_network_name": ["${var.company_prefix}-${var.environment}-cicd-vnet"], "__address__": "module.network.azurerm_subnet.cicd_private_endpoints", "__provider_address__": "azurerm.default"}}}, "evaluated_keys": ["resource_type", "name", "delegation/service_delegation/name"]}, "code_block": [[137, "resource \"azurerm_subnet\" \"cicd_private_endpoints\" {\n"], [138, "  name                 = \"cicd-private-endpoints-subnet\"\n"], [139, "  resource_group_name  = var.network_resource_group_name\n"], [140, "  virtual_network_name = azurerm_virtual_network.cicd.name\n"], [141, "  address_prefixes     = [local.subnets.cicd_private_endpoints]\n"], [142, "\n"], [143, "  private_endpoint_network_policies_enabled = false\n"], [144, "}\n"]], "file_path": "/terraform/modules/network/main.tf", "file_abs_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "repo_file_path": "/terraform/modules/network/main.tf", "file_line_range": [137, 144], "resource": "module.network.azurerm_subnet.cicd_private_endpoints", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "breadcrumbs": {"resource_group_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_resource_group_name", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}], "virtual_network_name": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "naming_prefix", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.aks", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.cicd", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.hub", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "address_prefixes": [{"type": "locals", "name": "subnets", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/tmp/workspaces/4ae5bd67-feea-4ee6-99f6-21fb47b3e8bd/code/terraform/main.tf", "idx": 6, "source_module_object": null}]}}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 30, "failed": 18, "skipped": 0, "parsing_errors": 0, "resource_count": 54, "checkov_version": "3.2.495"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}